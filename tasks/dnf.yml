---
- name: Install dnf5-plugins (needed for config-manager)
  dnf:
    name: dnf5-plugins
    state: present

- name: Add GitHub CLI repo
  command: dnf config-manager addrepo --from-repofile=https://cli.github.com/packages/rpm/gh-cli.repo
  args:
    creates: /etc/yum.repos.d/gh-cli.repo

- name: Install base dev packages
  dnf:
    name:
      # Build tools
      - gcc
      - gcc-c++
      - libasan
      - cmake
      - make
      - clang
      - clang-tools-extra
      - ninja-build
      - ccache
      - gdb
      # EDA
      - kicad
      # Version control & utils
      - git
      - gh
      - curl
      - wget
      - unzip
      - tar
      # Editor deps (neovim + LazyVim)
      - neovim
      - ripgrep
      - fd-find
      # Python
      - python3
      - python3-pip
      # Node (for lvim LSP tools)
      - nodejs
      - npm
      # ESP-IDF prereqs (per official docs)
      - flex
      - bison
      - gperf
      - python3-setuptools
      - python3-devel
      - dfu-util
      - libusbx
      - libusb1-devel
      - libffi-devel
      - openssl-devel
      # USB/serial (embedded)
      - minicom
      - screen
    state: present
    update_cache: true
